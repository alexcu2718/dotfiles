
## MEANT to be used on only bash/zsh

#shellcheck disable=2148
mysh() {
    ps -p $$ -o comm= | awk -F/ '{print $NF}' | sed 's/^-//'
}

CFG() {
    "$EDITOR" "$HOME/.$(mysh)rc"
}

REFRESH() {
    # shellcheck disable=SC1090
  source "$HOME/.$(mysh)rc"
}

alias pacman='pacman --noconfirm'
alias paru='paru --noconfirm'



unalias exportpath > /dev/null 2>&1
 # shellcheck disable=SC2139
alias SSH="ssh -p 2222 $USER@localhost"

unalias SSHCOPY > /dev/null 2>&1
SSHCOPY(){

  scp -r -P 2222 "$1" "$USER" @localhost:"$2"
}

unalias RSYNC > /dev/null 2>&1
RSYNC(){
  rsync -avz -e 'ssh -p 2222' "$1" alexc@localhost:"$2"
}

exportpath () {
  echo "export PATH=\$PATH:$1" >> ~/.shell_functions
}


if command -v juliaup >/dev/null 2>&1; then
eval "$(juliaup completions "$(mysh)")"
fi

# shellcheck disable=SC2139
alias SWITCH_KEYBOARD="$HOME/.toggle_keyboard_layout.sh"
alias R='R -q --interactive --no-restore --no-save'


alias radian='radian -q'


# Compilation flags
# shellcheck disable=SC2155

alias rg='rg --no-messages'

# export VSCODE_GIT_ASKPASS_NODE=/opt/visual-studio-code/code
# export VSCODE_GIT_ASKPASS_EXTRA_ARGS=""
# export VSCODE_GIT_ASKPASS_MAIN=/opt/visual-studio-code/resources/app/extensions/git/dist/askpass-main.js
# export VSCODE_GIT_IPC_HANDLE=/run/user/1000/vscode-git-038080b684.sock





alias cat='bat --paging=never --style=plain'
alias CLIPBOARD='xclip -sel clip'
alias cd='z'

alias CLIPPY='cargo clippy --all -- -W clippy::all -W clippy::pedantic -W clippy::restriction -W clippy::nursery -D warnings'
# shellcheck disable=SC2139
alias SHELLFUNCTIONS="$EDITOR ~/.shell_functions"
KILL() { [ $# -eq 0 ] && { echo "Usage: KILL <process_name>"; return 1; }; pgrep "$1" >/dev/null || { echo "No process: $1"; return 1; }; pkill -9 "$1"; }
#unalias ZIP >  /dev/null/

ZIP () {
	zip -r "$1.zip" "$1"
}

alias ssh='TERM=xterm ssh'
alias GITBRANCH='echo "$(git branch -r)"'
alias GITLINK='git -C "$(git rev-parse --show-toplevel)" remote get-url origin'

alias RUNBSD='qemu-system-x86_64 \
  -enable-kvm \
  -cpu host \
  -smp 8,sockets=1,cores=4,threads=2 \
  -m 8000 \
  -drive file="$HOME/Downloads/freebsd.qcow2",format=qcow2 \
  -netdev user,id=mynet0,hostfwd=tcp::2222-:22 \
  -device e1000,netdev=mynet0 \
  -device virtio-balloon \
  -display sdl

'


alias RUNBSD_NOGRAPHIC='qemu-system-x86_64 \
  -enable-kvm \
  -cpu host \
  -smp 8,sockets=1,cores=4,threads=2 \
  -m 8000 \
  -drive file="$HOME/Downloads/freebsd.qcow2",format=qcow2 \
  -netdev user,id=mynet0,hostfwd=tcp::2222-:22 \
  -device e1000,netdev=mynet0 \
  -device virtio-balloon \
   -nographic'



alias RUNOSX='cd ~/OSX-KVM && ./OpenCore-Boot.sh'

#alias RUNOSX_UI='cd ~/OSX-KVM && ./OpenCore-Boot-windowed.sh'


alias TEST_INTERNET="timeout 10 ping google.com"
alias RESTART_INTERNET=" sudo systemctl restart NetworkManager.service"
# I have a shoddy router that is increasingly annoying..................


# shellcheck disable=SC2139
alias RUNBIGENDIAN="qemu-system-ppc64 \
  -cpu POWER9 \
  -accel tcg,thread=multi \
  -M pseries,cap-cfpc=broken,cap-sbbc=broken,cap-ibs=broken \
  -m 12G,slots=4,maxmem=16G \
  -smp 8,cores=4,threads=2 \
  -drive file=\"$HOME/Downloads/debian-ppc64.img\",format=raw,if=virtio,aio=native,cache=directsync,discard=unmap \
  -netdev user,id=net0,hostfwd=tcp::2222-:22 \
  -device virtio-net-pci,netdev=net0 \
  -device virtio-balloon \
  -nographic -serial mon:stdio -monitor none"

# shellcheck disable=SC2139
alias RUNWINDOWS="qemu-system-x86_64 \
-machine type=q35,accel=kvm \
-enable-kvm \
-cpu Skylake-Client-v4,hv_relaxed,hv_vpindex,hv_time,hv_vapic,hv_runtime,hv_synic,hv_stimer,hv_tlbflush,hv_ipi,hv_frequencies \
-smp 2 \
-m 8096 -mem-prealloc \
-vga virtio \
-device virtio-keyboard-pci \
-device virtio-mouse-pci \
-display spice-app,gl=on \
-device ich9-intel-hda \
-device hda-duplex,audiodev=hda \
-audiodev pa,id=hda,server=unix:/run/user/1000/pulse/native,out.frequency=44100 \
-device virtio-net,netdev=vmnic \
-netdev user,id=vmnic,hostfwd=tcp::2222-:22 \
-device qemu-xhci,id=xhci \
-device usb-tablet,bus=xhci.0 \
-chardev spicevmc,id=vdagent,name=vdagent \
-device virtio-serial \
-device virtserialport,chardev=vdagent,name=com.redhat.spice.0 \
-chardev socket,path=/tmp/qga.sock,server=on,wait=off,id=qga0 \
-device virtserialport,chardev=qga0,name=org.qemu.guest_agent.0 \
-object rng-random,id=rng0,filename=/dev/urandom \
-device virtio-rng-pci,max-bytes=1024,period=1000 \
-drive format=raw,file=${HOME}/.qemu/windows_10/windows_10.img"


#i dont want to use the shitty js one, no npm!
alias gitmoji="go-gitmoji-cli"
alias GITRENEW='git fetch origin && git reset --hard origin/$(git rev-parse --abbrev-ref HEAD)'

alias INSTALLED_PACKAGES='paru -Qe'
alias CLEAR_PACKAGE_CACHE='paru -Sc'
alias sort='sort --parallel=$(nproc)'
alias grep='grep  --color=auto'
alias grepn='grep -n --color=auto'
alias hgrep='history |grep -Ei'

alias SLEEPOFF_ONE_HOUR='systemd-inhibit --what=sleep:idle --mode=block sleep "3600"'

if command -v fdf >/dev/null 2>&1; then
    eval "$(fdf --generate "$(mysh)")" >/dev/null 2>&1
fi



thunar() {
    command thunar "$@" &> /dev/null &
    disown
}


dolphin() {
    command dolphin "$@" &> /dev/null &
    disown
}

alias zed='zeditor'




alias code="\code --ozone-platform=wayland"
alias yay="\yay --noconfirm"

alias RESTARTCODE="pkill -9 code && \code . --ozone-platform=wayland "

alias PERF="perf stat -e cache-misses,cache-references,L1-dcache-load-misses,L1-dcache-loads,LLC-load-misses,LLC-loads,branches,branch-misses"

alias GITHELP="echo 'git checkout HEAD~2 -- EXAMPLE.FILENAME'"

alias GITRESETFILE="git checkout HEAD --"

alias REFRESHKEYS='sudo pacman-key --refresh-keys'
